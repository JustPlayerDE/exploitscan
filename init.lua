--[[
    You can run this in your console:

    lua_run http.Fetch("https://raw.githubusercontent.com/JustPlayerDE/exploitscan/master/init.lua", function(body) RunString(body) end)

    This will never use or add exploits.
]]
SCAN = {}
SCAN.Name = "Exploit Searcher"
SCAN.Author = "Justin KlÃ¼ver @JustPlayerDE"
SCAN.Version = ""
SCAN.Description = "Simple exploit searcher"
SCAN.Database = {} -- We load them later
SCAN.Results = {}

function SCAN.scan()
    print("Searching for possible exploits...")

    for netstr, description in pairs(SCAN.Database) do
        if util.NetworkStringToID(netstr) ~= 0 then
            print("[WARNING] Found netstring [" .. netstr .. "]. (Note: " .. description .. ")")

            if isfunction(net.Receivers[netstr]) then
                local netstrInfos = debug.getinfo(net.Receivers[netstr], "S")
                print("> " .. netstr .. " was declared in " .. netstrInfos.short_src .. " line " .. netstrInfos.linedefined)
            end
        end
    end

    print("Finished.")
end

print("Loading database...")

http.Fetch(SCAN_URL or "https://raw.githubusercontent.com/JustPlayerDE/exploitscan/master/string.json", function(body)
    SCAN.Database = util.JSONToTable(body)
    SCAN.scan()
end, function(error)
    error("Could not fetch informations for scan: " .. error)
end)