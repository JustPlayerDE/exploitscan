--[[
    You can run this in your console:

    lua_run http.Fetch("https://raw.githubusercontent.com/JustPlayerDE/exploitscan/master/init.lua", function(body) RunString(body) end)

    This will never use or add exploits.
]]
SCAN = {}
SCAN.Name = "Exploit Searcher"
SCAN.Author = "Justin Kl√ºver @JustPlayerDE"
SCAN.Version = "1.0.0"
SCAN.Description = "Simple exploit searcher"
SCAN.Database = {} -- We load them later
SCAN.Results = {} -- Will be used later

function SCAN.scan(list)
    print("Searching for possible exploits...")

    for netstr, description in pairs(list) do
        if util.NetworkStringToID(netstr) ~= 0 then
            local handler = "Not Found. (Server to Client?)."
            local netstr = netstr:lower()

            if isfunction(net.Receivers[netstr]) then
                local netstrInfos = debug.getinfo(net.Receivers[netstr], "S")
                handler = netstrInfos.short_src .. ":" .. netstrInfos.linedefined
            end

            print("[WARNING] Found netstring [" .. netstr .. "]. (Note: " .. description .. ") File: " .. handler)
        end
    end

    SCAN.Database = {} -- free up some memory
    print("Finished.")
end

print("Loading database...")

http.Fetch(SCAN_URL or "https://raw.githubusercontent.com/JustPlayerDE/exploitscan/master/string.json", function(body)
    SCAN.scan(util.JSONToTable(body))
end, function(error)
    error("Could not fetch informations for scan: " .. error)
end)
